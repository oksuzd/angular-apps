"use strict";(self.webpackChunkangular_apps=self.webpackChunkangular_apps||[]).push([[430],{7430:(ct,w,s)=>{s.r(w),s.d(w,{WeatherModule:()=>tt});var a=s(6814),u=s(8645),C=s(4664),_=s(6306),f=s(8504),m=s(9773),t=s(9468),p=s(7398);const O="https://api.geoapify.com/v1/geocode/",v="d062e33a6330458e8916f4d31c04d69c";var h,n;(n=h||(h={})).getQuery=function c(i){return i.split(" ").join("+").toLowerCase()},n.getLocationId=function e(i,o,r,x){return`${i.toString().split(".")[0]},${o.toString().split(".")[0]},${r?r.toLowerCase().split(" ").join("-"):""},${x.toLowerCase()}`};var L=s(9862);let g=(()=>{class n{constructor(e){this.http=e,this.photoWidth=544,this.photoHeight=406}getIpLocation(){return this.http.get("https://api.ipgeolocation.io/ipgeo?apiKey=965442015ea34e90833aed17dfcb6730").pipe((0,p.U)(i=>this.mapIpLocation(i)))}getGeoLocationByCoordinates(e,i){return this.http.get(O+`reverse?lat=${e}&lon=${i}\n    &type=city&lang=en&limit=1&format=json&apiKey=${v}`).pipe((0,p.U)(r=>this.mapWeatherLocation(r.results[0])))}getAutocompleteCityResults(e){return this.http.get(O+`autocomplete?text=${e}&limit=5\n    &type=city&format=json&apiKey=${v}`).pipe((0,p.U)(o=>this.mapWeatherLocationsList(o)))}getCityPhotos(e){let i=`https://pixabay.com/api/?key=38775328-c94f2902c933f55ec1d58d134&q=${h.getQuery(e)}&orientation=horizontal&category\n    =backgrounds&min_width=${this.photoWidth}min_height=${this.photoHeight}&image_type=photo&pretty=true`;return this.http.get(i).pipe((0,p.U)(o=>this.mapPhotos(o)))}getWeatherData(e){const i=`https://api.weatherapi.com/v1/current.json?key=4274b162ef6140ccbce113341231108&q=${h.getQuery(e)}&`;return this.http.get(i).pipe((0,p.U)(o=>this.mapWeatherData(o)))}mapWeatherData(e){const i=e.current;return{tempCelsius:i.temp_c,conditionText:i.condition.text,conditionIcon:i.condition.icon,windSpeedKph:i.wind_kph,windDir:i.wind_dir,pressureMb:i.pressure_mb,humidity:i.humidity,feelsLike:i.feelslike_c,visibilityKm:i.vis_km,uv:i.uv}}mapPhotos(e){return e.hits.filter(i=>i.webformatHeight>=this.photoHeight).map(i=>i.webformatURL)}mapIpLocation(e){return{id:h.getLocationId(e.latitude,e.longitude,e.city,e.country_code2),latitude:e.latitude.toString(),longitude:e.longitude.toString()}}mapWeatherLocationsList(e){let i=[];return e.results.forEach(o=>{o.city&&i.push(this.mapWeatherLocation(o))}),i}mapWeatherLocation(e){return{id:h.getLocationId(e.lat,e.lon,e.city,e.country_code),latitude:String(e.lat),longitude:String(e.lon),country:e.country,countryCode:e.country_code,city:e.city,formatted:e.formatted}}saveLocalStorageLocationsList(e){localStorage.setItem("locationsList",JSON.stringify(e))}loadLocalStorageLocationsList(){return JSON.parse(localStorage.getItem("locationsList"))}deleteLocalStorageLocationsItem(e){let i=JSON.parse(localStorage.getItem("locationsList"));i=i.filter(o=>o.id!==e),localStorage.setItem("locationsList",JSON.stringify(i))}clearLocalStorageLocationsList(){localStorage.removeItem("locationsList")}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(L.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();var S=s(5619);const k={id:"",latitude:"",longitude:""};let d=(()=>{class n{constructor(){this._location$=new S.X(k),this.location$=this._location$.asObservable()}setLocationState(e){this._location$.next(e)}getLocationState(){return this._location$.getValue()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();var A=s(2181),U=s(9315),M=s(2096),y=s(5195);const W=function(n){return{backgroundImage:n}};function D(n,c){if(1&n&&(t.TgZ(0,"mat-card",1)(1,"mat-card-content",2)(2,"div",3)(3,"mat-card-title",4),t._uU(4),t.qZA(),t.TgZ(5,"div",5),t._UZ(6,"img",6),t.TgZ(7,"div",7),t._uU(8),t.TgZ(9,"div",8),t._uU(10,"C"),t.qZA()()()(),t.TgZ(11,"div",9)(12,"span"),t._uU(13),t.qZA(),t._UZ(14,"br"),t.TgZ(15,"span"),t._uU(16),t.qZA(),t._UZ(17,"br"),t.TgZ(18,"span"),t._uU(19),t.ALo(20,"number"),t.qZA(),t._UZ(21,"br"),t.TgZ(22,"span"),t._uU(23),t.qZA(),t._UZ(24,"br"),t.TgZ(25,"span"),t._uU(26),t.qZA()()()()),2&n){const e=c.ngIf,i=t.oxw();t.Q6J("ngStyle",t.VKq(13,W,i.getBackgroundImage())),t.xp6(4),t.Oqu(i.cityName),t.xp6(2),t.s9C("src",e.conditionIcon,t.LSH),t.xp6(2),t.hij("",e.tempCelsius," "),t.xp6(5),t.Oqu(e.conditionText),t.xp6(3),t.hij("Feels like: ",e.feelsLike," C"),t.xp6(3),t.AsE("Wind: ",t.xi3(20,10,e.windSpeedKph/3.6,"1.1-1")," mps ",e.windDir,""),t.xp6(4),t.hij("Humidity: ",e.humidity,"%"),t.xp6(3),t.hij("Pressure: ",e.pressureMb," mb")}}let J=(()=>{class n{constructor(e,i,o){this.weatherServiceData=e,this.weatherStoreService=i,this.cdr=o,this.cityName="",this.notifier$=new u.x}ngOnInit(){this.setWeather()}ngOnDestroy(){this.notifier$.next(null),this.notifier$.complete()}setWeather(){this.weatherStoreService.location$.pipe((0,A.h)(e=>!!e.city),(0,C.w)(e=>{const i=`${e.city} ${e.country}`;return(0,U.D)([this.weatherServiceData.getCityPhotos(i),this.weatherServiceData.getWeatherData(i),(0,M.of)(e.city)])}),(0,m.R)(this.notifier$),(0,_.K)(e=>(0,f._)(()=>e))).subscribe(([e,i,o])=>{this.cityPhotos=e,this.cityWeather=i,this.cityName=o,this.cdr.detectChanges()})}getBackgroundImage(){return this.cityPhotos.length>0?`url(${this.cityPhotos[Math.floor(Math.random()*this.cityPhotos.length)]})`:"url(/assets/img/weather.jpg)"}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g),t.Y36(d),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-day-weather"]],decls:1,vars:1,consts:[["class","weather-widget_card",3,"ngStyle",4,"ngIf"],[1,"weather-widget_card",3,"ngStyle"],[1,"weather-widget_info","blur"],[1,"weather-widget_info-left"],[1,"weather-widget_title"],[1,"weather-widget_temp-info"],["alt","condition icon","width","64","height","64",1,"weather-widget_condition-icon",3,"src"],[1,"weather-widget_temperature"],[1,"weather-widget_celsius"],[1,"weather-widget_info-right"]],template:function(e,i){1&e&&t.YNc(0,D,27,15,"mat-card",0),2&e&&t.Q6J("ngIf",i.cityWeather)},dependencies:[a.O5,a.PC,y.a8,y.dn,y.n5,a.JJ],styles:["[_nghost-%COMP%]   .weather-widget_card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;width:544px;height:406px;background-repeat:no-repeat;border-radius:8px}[_nghost-%COMP%]   .weather-widget_title[_ngcontent-%COMP%]{margin-left:12px;margin-top:8px;font-size:28px;line-height:26px;color:#fff}[_nghost-%COMP%]   .weather-widget_info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:auto;padding:0;border-top:1px solid rgba(255,255,255,.3);color:#fff;border-radius:0 0 8px 8px}[_nghost-%COMP%]   .weather-widget_temp-info[_ngcontent-%COMP%]{display:flex;align-items:center;margin-left:8px}[_nghost-%COMP%]   .weather-widget_info-right[_ngcontent-%COMP%]{min-width:175px;margin:10px 12px 10px 0!important;text-align:right;font-size:16px;line-height:18px}[_nghost-%COMP%]   .weather-widget_condition-icon[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .weather-widget_condition-text[_ngcontent-%COMP%]{text-align:center;font-size:20px}[_nghost-%COMP%]   .weather-widget_temperature[_ngcontent-%COMP%]{position:relative;font-size:40px}[_nghost-%COMP%]   .weather-widget_celsius[_ngcontent-%COMP%]{position:absolute;right:-12px;top:-13px;font-size:18px}[_nghost-%COMP%]   .blur[_ngcontent-%COMP%]{background:rgba(49,49,49,.26);-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}"],changeDetection:0}),n})();var Y=s(2296);function F(n,c){1&n&&(t.TgZ(0,"div",6),t._uU(1,"Please, wait..."),t.qZA())}function E(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.chooseLocation(o.currentLocation))}),t.TgZ(1,"button",8),t._uU(2),t.ALo(3,"uppercase"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.AsE(" ",e.currentLocation.city,", ",t.lcZ(3,2,e.currentLocation.countryCode)," ")}}function N(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.chooseLocation(o))}),t._uU(1),t.ALo(2,"uppercase"),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.AsE(" ",e.city,", ",t.lcZ(2,2,e.countryCode)," ")}}function K(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.deleteLocation(o))}),t._uU(1," X "),t.qZA()}}function H(n,c){if(1&n&&(t.TgZ(0,"li",15),t.YNc(1,N,3,4,"button",16),t.YNc(2,K,2,0,"button",17),t.qZA()),2&n){const e=c.first;t.xp6(1),t.Q6J("ngIf",!e),t.xp6(1),t.Q6J("ngIf",!e)}}function j(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",2)(2,"h3"),t._uU(3,"List of cities"),t.qZA()(),t.TgZ(4,"div",10)(5,"ul",11),t.YNc(6,H,3,2,"li",12),t.qZA()(),t.TgZ(7,"div",13)(8,"button",14),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.clearLocationsList())}),t._uU(9," Clear the list "),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(6),t.Q6J("ngForOf",e.listOfLocations)}}let z=(()=>{class n{constructor(e,i,o){this.weatherStoreService=e,this.weatherDataService=i,this.cdr=o,this.currentLocation={id:"",latitude:"",longitude:""},this.listOfLocations=[],this.notifier$=new u.x}ngOnInit(){this.listOfLocations=this.weatherDataService.loadLocalStorageLocationsList()??[],this.createSubscriptionOnLocation(),this.cdr.detectChanges()}ngOnDestroy(){this.notifier$.next(null),this.notifier$.complete()}createSubscriptionOnLocation(){this.weatherStoreService.location$.pipe((0,m.R)(this.notifier$),(0,_.K)(e=>(0,f._)(()=>e))).subscribe(e=>{this.currentLocation=e,""!==e.id&&(this.listOfLocations=this.listOfLocations.filter(i=>i.id!==e.id),this.listOfLocations.unshift(e),this.weatherDataService.saveLocalStorageLocationsList(this.listOfLocations),this.cdr.detectChanges())})}chooseLocation(e){this.weatherStoreService.setLocationState(e)}deleteLocation(e){this.listOfLocations=this.listOfLocations.filter(i=>i.id!==e.id),this.cdr.detectChanges(),this.weatherDataService.deleteLocalStorageLocationsItem(e.id)}clearLocationsList(){this.weatherDataService.clearLocalStorageLocationsList(),this.listOfLocations.length=1,this.cdr.detectChanges()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d),t.Y36(g),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-city-list"]],decls:8,vars:3,consts:[[1,"cities-list"],[1,"cities-list_current-city"],[1,"cities-list_title"],["class","cities-list_item cities-list_item-current item-placeholder ",4,"ngIf"],["class","cities-list_item cities-list_item-current",3,"click",4,"ngIf"],["class","cities-list_list-wrap",4,"ngIf"],[1,"cities-list_item","cities-list_item-current","item-placeholder"],[1,"cities-list_item","cities-list_item-current",3,"click"],["mat-button","","color","primary",1,"cities-list_item-name"],[1,"cities-list_list-wrap"],[1,"cities-list_items-wrap"],[1,"cities-list_items"],["class","cities-list_item",4,"ngFor","ngForOf"],[1,"cities-list_clear"],["mat-button","","color","warn",3,"click"],[1,"cities-list_item"],["class","cities-list_item-name","mat-button","","color","primary",3,"click",4,"ngIf"],["class","cities-list_item-delete","mat-button","","color","warn",3,"click",4,"ngIf"],["mat-button","","color","primary",1,"cities-list_item-name",3,"click"],["mat-button","","color","warn",1,"cities-list_item-delete",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),t._uU(4,"Current City"),t.qZA()(),t.YNc(5,F,2,0,"div",3),t.YNc(6,E,4,4,"div",4),t.qZA(),t.YNc(7,j,10,1,"div",5),t.qZA()),2&e&&(t.xp6(5),t.Q6J("ngIf",!i.currentLocation.id),t.xp6(1),t.Q6J("ngIf",i.currentLocation.id),t.xp6(1),t.Q6J("ngIf",i.listOfLocations.length>1))},dependencies:[a.sg,a.O5,Y.lW,a.gd],styles:["[_nghost-%COMP%]{height:100%}[_nghost-%COMP%]   .cities-list[_ngcontent-%COMP%]{width:200px;height:100%;border-left:1px solid #fbe1ff;background-color:#faeaff;word-break:break-word}[_nghost-%COMP%]   .cities-list_title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{padding:4px;margin:0;font-size:16px;text-align:center;color:#7b1fa2}[_nghost-%COMP%]   .cities-list_list-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-top:2px solid #fbe1ff}[_nghost-%COMP%]   .cities-list_items-wrap[_ngcontent-%COMP%]{height:calc(100vh - 226px);overflow-y:auto}[_nghost-%COMP%]   .cities-list_items[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none}[_nghost-%COMP%]   .cities-list_item-current[_ngcontent-%COMP%]{height:48px;overflow-y:auto}[_nghost-%COMP%]   .cities-list_item[_ngcontent-%COMP%]{display:flex;align-items:center}[_nghost-%COMP%]   .cities-list_item-name[_ngcontent-%COMP%]{width:100%;height:100%;padding:8px;justify-content:initial;text-align:initial;font-size:14px;letter-spacing:initial;line-height:16px}[_nghost-%COMP%]   .cities-list_item-delete[_ngcontent-%COMP%]{min-width:32px;height:32px;font-size:12px;font-weight:700;color:#e08fed}[_nghost-%COMP%]   .cities-list_clear[_ngcontent-%COMP%]{border-top:2px solid #fbe1ff;padding-top:8px;padding-bottom:8px;text-align:center}[_nghost-%COMP%]   .cities-list_clear[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;color:#e08fed}[_nghost-%COMP%]   .item-placeholder[_ngcontent-%COMP%]{padding:8px;font-size:14px;letter-spacing:initial;line-height:16px;color:#b96bb9}"],changeDetection:0}),n})();var Q=s(3620),l=s(6223);function B(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",5),t.NdJ("click",function(){const r=t.CHM(e).$implicit,x=t.oxw();return t.KtG(x.chooseCity(r))}),t._uU(1),t.qZA()}if(2&n){const e=c.$implicit;t.xp6(1),t.hij("",e.formatted," ")}}let R=(()=>{class n{constructor(e,i,o){this.weatherStoreService=e,this.weatherDataService=i,this.cdr=o,this.inputCity="",this.citiesVariants=[],this.notifier$=new u.x,this._inputCity$=new S.X(""),this.inputCity$=this._inputCity$.asObservable()}ngOnInit(){this.getCityVariants()}ngOnDestroy(){this.notifier$.next(null),this.notifier$.complete()}getCityVariants(){this.inputCity$.pipe((0,Q.b)(500),(0,C.w)(e=>e.length>=3?this.weatherDataService.getAutocompleteCityResults(e):(0,M.of)([])),(0,_.K)(e=>(0,f._)(()=>e)),(0,m.R)(this.notifier$)).subscribe(e=>{this.citiesVariants=e,this.cdr.detectChanges()})}setSearchingCity(e){this._inputCity$.next(e)}chooseCity(e){this.weatherStoreService.setLocationState(e),this.clearSearch()}onClick(e){e.classList.contains("search_city")||this.clearSearch()}onKeyUp(e){0!=this.citiesVariants.length&&"Escape"===e.key&&this.clearSearch()}clearSearch(){this.citiesVariants=[],this.inputCity=""}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d),t.Y36(g),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-city-search"]],hostBindings:function(e,i){1&e&&t.NdJ("click",function(r){return i.onClick(r.target)},!1,t.Jf7)("keyup",function(r){return i.onKeyUp(r)},!1,t.Jf7)},decls:5,vars:2,consts:[[1,"search_form"],[1,"search_wrapper"],["name","inputCity","type","text","placeholder","Enter the name of the city",1,"search_city","search_input",3,"ngModel","ngModelChange"],[1,"search_results"],["class","search_city search_result-item",3,"click",4,"ngFor","ngForOf"],[1,"search_city","search_result-item",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0)(1,"div",1)(2,"input",2),t.NdJ("ngModelChange",function(r){return i.inputCity=r})("ngModelChange",function(r){return i.setSearchingCity(r)}),t.qZA(),t.TgZ(3,"div",3),t.YNc(4,B,2,1,"div",4),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("ngModel",i.inputCity),t.xp6(2),t.Q6J("ngForOf",i.citiesVariants))},dependencies:[a.sg,l._Y,l.Fj,l.JJ,l.JL,l.On,l.F],styles:["[_nghost-%COMP%]{width:100%;padding:16px;text-align:center}[_nghost-%COMP%]   .search_wrapper[_ngcontent-%COMP%]{position:relative;width:372px;margin:auto}[_nghost-%COMP%]   .search_city[_ngcontent-%COMP%]{width:100%;min-height:38px;padding-left:10px;padding-right:10px;border:none;font-size:16px;color:#805088}[_nghost-%COMP%]   .search_input[_ngcontent-%COMP%]{outline:none;background:white;border-bottom:2px solid #fbe1ff;border-radius:5px 5px 0 0;box-shadow:0 2px 1px -1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f}[_nghost-%COMP%]   .search_input[_ngcontent-%COMP%]::placeholder{color:#c281c2;opacity:1}[_nghost-%COMP%]   .search_results[_ngcontent-%COMP%]{position:absolute;z-index:1;left:0;padding-top:3px;padding-bottom:5px;background:#fbe1ff;border-radius:0 0 5px 5px;box-shadow:0 2px 1px -1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f}[_nghost-%COMP%]   .search_result-item[_ngcontent-%COMP%]{width:372px;background:white;text-align:initial;padding-top:10px;padding-bottom:6px}[_nghost-%COMP%]   .search_result-item[_ngcontent-%COMP%]:hover{cursor:pointer;background:#faeaff;transition:opacity .3s}[_nghost-%COMP%]   .search_result-item[_ngcontent-%COMP%]:active{cursor:pointer;background:#faf1ff}"],changeDetection:0}),n})(),G=(()=>{class n{constructor(e,i){this.weatherDataService=e,this.weatherStoreService=i,this.notifier$=new u.x}ngOnInit(){""===this.weatherStoreService.getLocationState().id&&this.weatherDataService.getIpLocation().pipe((0,C.w)(e=>this.weatherDataService.getGeoLocationByCoordinates(e.latitude,e.longitude)),(0,_.K)(e=>(0,f._)(()=>e)),(0,m.R)(this.notifier$)).subscribe(e=>{this.weatherStoreService.setLocationState(e)})}ngOnDestroy(){this.notifier$.next(null),this.notifier$.complete()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g),t.Y36(d))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-weather"]],decls:6,vars:0,consts:[[1,"weather-wrap"],[1,"weather-widget"],[1,"weather-widget_tools"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"app-city-search"),t.qZA(),t._UZ(4,"app-day-weather"),t.qZA(),t._UZ(5,"app-city-list"),t.qZA())},dependencies:[J,z,R],styles:["[_nghost-%COMP%]{width:100%}[_nghost-%COMP%]   .weather-wrap[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;height:100%}[_nghost-%COMP%]   .weather-wrap[_ngcontent-%COMP%]   .weather-widget[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;height:100%}[_nghost-%COMP%]   .weather-wrap[_ngcontent-%COMP%]   .weather-widget_tools[_ngcontent-%COMP%]{display:flex;width:100%}"]}),n})();var q=s(3403),V=s(3732);const X=[{path:"",component:G}];let tt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[g,d],imports:[a.ez,L.JF,q.Bz.forChild(X),V.m,l.UX,l.u5]}),n})()}}]);